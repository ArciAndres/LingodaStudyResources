sndefine("font-loader",["utils","filefetcher","global"],(function(e,t,i){var s=this.document;return function(n,o,r){return o.querySelectorAll("style").forEach((function(e){var t=n.indexOf(e.getAttribute("data-href"));~t&&n.splice(t,1)})),i.Promise.all(n.map((function(e){return n.includes("?")&&(e+="&display=swap"),function(e){return t(e).then((function(e){return e.clone().text()}),(function(){return i.Promise.reject(e)}))}(e)}))).then((function(t){for(let[i,s]of e.entries(t)){let e=o.createElement("style");e.setAttribute("data-href",n[i]),e.textContent=s,o.head.appendChild(e)}let i=[];for(let t of e.values(r))for(let e of t.weights)i.push(s.fonts.load(`normal normal ${e} 12px/1.2 ${t.family}`));return e.allSettled(i)}),(function(e){return i.Promise.reject(e)}))}})),sndefine("spacer",["browser","utils","css","layout","core-sleeknote","behaviour"],(function(e,t,i,s,n,o){var r={},a={};function c(e){this.note=e,this.config=o.defaults("spacer",e.config),this.dimensions=function(){return{width:this.config.style.width,height:this.config.height}}}function h(){this.reset()}function l(e){var n=e.config,o=t.qsa(n.selector,s.viewport.parentNode)[0];return n.DOMNode=t.insertHTML(o,t.template('<span class={className} style="{style}"></span>',{className:s.sleeknoteWrap,id:n.id,style:i.inline(n.style)}),n.insert),e}return h.prototype={reset:function(){return a={},this},set:function(e){var t=new c(e);return"close"==t.config.next&&a[t.config.id]||(a[t.config.id]=t),this},execute:function(e){var t;for(t in r)r.hasOwnProperty(t)&&(a[t]?(this.create(a[t]),delete a[t]):e||this.destroy(r[t]));for(t in a)a.hasOwnProperty(t)&&(this.create(a[t]),delete a[t]);return this},reposition:function(){var e,i;for(e in r)r.hasOwnProperty(e)&&((i=r[e]).config=t.extend(i.config,o.defaults("spacer",i.note.config)),s.css(i.config,"DOMNode",{height:i.dimensions().height}))},css:function(e,i){s.css(e.config,"DOMNode",t.extend({},i.to.animate,e.config.style))},create:function(e){var t=e.config.id;if(r[t]){var s=r[t].config.DOMNode;r[t]=e,r[t].config.DOMNode=s}else r[t]=l.call(this,e),i.reveal(r[t].config.DOMNode);var n=o.animationParameters(r[t],"close","open",r[t].note);this.css(r[t],n)},destroy:function(e){var i=e.config.id;if(r[i]){var s=o.animationParameters(r[i],"open","close",r[i].note);"shared"==r[i].config.kind?this.css(r[i],s):(t.removeNode(r[i].config.DOMNode),delete r[i])}}},h})),sndefine("cover-screen",["browser","utils","css","layout","core-sleeknote","behaviour"],(function(e,t,i,s,n,o){function r(){this.config=o.defaults("cover",{})}return r.prototype={dimensions:function(){return this.config.width=n.editor?"100%":"101vw",this.config.height=n.editor?"100%":"101vh",this.config},insert:async function(){let e='<style>html{cursor:pointer;background:radial-gradient(ellipse at center, rgba(0,0,0,0.1) 40%,rgba(0,0,0,0.6) 100%)}body:{margin:0}</style><div style="height:100vh" onclick="void(0)"></div>';n.editor&&(e='<div style="height:100%; width:100%; cursor:pointer;background:radial-gradient(ellipse at center, rgba(0,0,0,0.1) 40%,rgba(0,0,0,0.6) 100%); pointer-events:auto!important"></div>');let{wrapNode:t}=await s.insert({parent:s.viewport,what:"cover",config:this.config,id:"sleeknote-cover",content:e,style:{cursor:"pointer"}});this.config.DOMNode=t},remove:function(){this.config.DOMNode&&(this.removeListener(),t.removeNode(this.config.DOMNode))},after:function(){this.config.DOMNode&&"close"==this.config.current&&i.conceal(this.config.DOMNode)},reposition:function(e,t){if(this.config.DOMNode){var i=o.needs.cover(e)?"open":"close";s.css(this.config,"DOMNode",s.createPositionStyles(o.boxParameters(this,i),"to")),this.config.current=i,this.after()}},prepare:async function(e,t){var n=this.config.current;if(this.config.DOMNode&&e!=n)return this.config.next=e,this.params=o.animationParameters(this,n,e),this.params.width,s.createMotion(this.params,function(e,t,n){s.css(this.config,"DOMNode",e),n&&(this.config.current=this.config.next,"close"==this.config.current&&i.conceal(this.config.DOMNode))}.bind(this))}},r})),sndefine("orchestrator",["browser","utils","animator","core-sleeknote","spacer","behaviour","layout","cover-screen","constants","click","event-emitter","global"],(function(e,t,i,s,n,o,r,a,c,h,l,g){var f=this,u=s.CustomInitSettings.noIFrames,d=s.editor||s.preview;const m=c.CORE.COMMANDS;function p(e,t,i,s){if(!(this instanceof p))return new p(e,t,i,s);e instanceof p?(this.campaign=e.campaign,this.command=e.command,this.noteName=e.noteName,this.callback=e.callback):(this.campaign=e,this.command=t,this.noteName=i,this.callback=s)}function v(){this.visibles={},this.queue=[],this.busy=!1,this.spacer=new n}return v.prototype={get empty(){return!Object.keys(this.visibles).length},get stopper(){var e;for(e in this.visibles)if(this.visibles.hasOwnProperty(e)&&this.isStopper(this.visibles[e]))return this.visibles[e]},getBoxType:function(e){return e.campaign?e.campaign.notes[e.noteName].config.type:""},isStopper:function(e){if(!e||e.campaign.isHello)return!1;if(s.editor)return!0;return"concurrent"!=(c.PROFILE.MOBILE==e.campaign.config.profile?"sequential":s.custom("notemanagermode")||"concurrent")||t.contains(this.getBoxType(e),"form","success")},addToVisibles:function(e,t){var i=this.visibles[e.id];return i?i.noteName=t:i=this.visibles[e.id]=p(e,"",t),i},removeFromVisibles:function(e){if(e=this.visibles[e.campaign.id])return delete this.visibles[e.campaign.id],e},extractCloseRequest:function(){for(var e,t=this.queue.length;t--;)if(this.queue[t].command==m.CLOSE)return e=this.queue[t],this.queue.splice(t,1),e},positionIsOccupied:function(e){var t,i;for(t in this.visibles)if(this.visibles.hasOwnProperty(t)&&(i=this.visibles[t]).campaign.config.position==e.config.position)return i},extractHello:function(){for(var e,t=this.queue.length;t--;)if((e=this.queue[t]).campaign.isHello&&e.command!=m.CLOSE&&"form"==this.getBoxType(e)&&!this.positionIsOccupied(e.campaign))return this.queue.splice(t,1),e},triggerCommand:function(e){l(e.command,{creator:c.CORE.CREATOR.API,name:e.noteName,origin:e.campaign.notes[e.noteName],trigger:"queue"})},next:async function(e,n,g){var p,v,b,N;if(!this.queue.length)return;let E=[];for(;p=this.extractCloseRequest();)E.push(p),this.removeFromVisibles(p),g||this.triggerCommand(p);if(!s.editor)for(;p=this.extractHello();)E.push(p),this.addToVisibles(p.campaign,p.noteName),this.triggerCommand(p);for(;;){if(this.queue.length){if(!e&&this.stopper&&this.isStopper(this.queue[0]))break;if(!s.editor&&this.queue[0].campaign.isHello&&(p=this.positionIsOccupied(this.queue[0].campaign))&&p.campaign!=this.queue[0].campaign)break;v=this.queue.shift();let i=t.contains(v.command,m.OPEN,m.REVEAL);if((p=this.visibles[v.campaign.id])&&p.noteName==v.noteName&&i)break;E.push(v),(p=this.visibles[v.campaign.id])&&i&&(p.command=m.CLOSE,b=p.noteName,E.push(p),this.removeFromVisibles(p)),this.isStopper(v)&&(p=this.stopper)&&(p.command=m.CLOSE,E.push(p),this.removeFromVisibles(p),d||this.add("unshift",p.campaign,m.OPEN,p.noteName)),this.addToVisibles(v.campaign,v.noteName),e||this.triggerCommand(v)}break}if(!E.length)return;var O,y=[];function w(){if(O)return y=y.concat(O),O=!1,!0}this.spacer.reset();var I=v&&v.campaign.notes[v.noteName];if(s.needBadge){if(!this.badge){let e=await f.arequire("badge");this.badge=new e,await this.badge.insert()}O=this.isStopper(v)&&o.needs.badge(I.config)?await this.badge.prepare(m.OPEN,I):await this.badge.prepare(m.CLOSE)}if(w(),I&&o.needs.cover(I.config)){if(!this.cover&&(this.cover=new a(this.viewport),await this.cover.insert(),!d)){let e=this.cover.config.DOMNode;h.listen(u?e.firstElementChild:r.doc(e),(e=>{let t=this.stopper;if(!t)return;let i=t.campaign.notes[t.noteName],s=i.doc.querySelectorAll("[data-sn-type=close], .sleeknoteMobileClose")[0];s&&i.onClick(e,s)}))}O=await this.cover.prepare(m.OPEN,I)}else{var C=this.stopper;C&&o.needs.cover(C.campaign.notes[C.noteName].config)||this.cover&&(O=await this.cover.prepare(m.CLOSE))}w();var S,M=v&&v.noteName;for(let e of t.values(E)){let t;v&&e.campaign==v.campaign&&(t=e.noteName==v.noteName?b:M),O=await e.campaign.prepareNote(e.noteName,e.command,t),S=e.campaign.notes[e.noteName],w()&&e.command!=m.CLOSE&&o.needs.spacer(S.config)&&this.spacer.set(S)}for(let e of t.keys(this.visibles))S=this.visibles[e].campaign.notes[this.visibles[e].noteName],o.needs.spacer(S.config)&&this.spacer.set(S);this.spacer.execute(),N=E.length,r.prepareForAnimation(y);let x=new i;return x.add(y),n?(x.playLastFrame(),this.after(E,x)):(this.busy=!0,x.play((()=>{this.after(E,x)}),(()=>{l(c.CORE.EVENTS.ANIMATING,{status:!0,animator:x})}))),N},resolve:function(e){e&&e.callback&&f.requestAnimationFrame((()=>{e.callback("after")}))},after:function(e,i){this.busy&&(this.busy=!1,l(c.CORE.EVENTS.ANIMATING,{status:!1,animator:i}));let s={opened:[],closed:[]};for(let i of t.values(e))s[i.command==m.CLOSE?"closed":"opened"].push(i);l(c.CORE.EVENTS.VISIBLE,s);for(var n,o=e.length;o--;)(n=e[o]).campaign.afterAnimation(n.noteName),this.resolve(n);f.requestAnimationFrame((()=>{this.next(d)}))},add:function(e,t,i,s,n,o){var r=this.queue.length,a=t.config.campaignId;if(a in this.visibles&&this.visibles[a].noteName==s&&this.visibles[a].campaign.notes[s].visible==i)return;for(;r--&&this.queue[r].campaign!=t;);return~r?this.queue[r].command==m.CLOSE&&i==m.OPEN?(this.queue[e](p(t,i,s,n)),!0):(d&&(o=!0),o?(this.queue.splice(r,1),this.add(e,t,i,s,n)):"unshift"==e&&0===r):(this.queue[e](p(t,i,s,n)),!0)},indexOf:function(e){for(var t=this.queue.length;t--;)if(this.queue[t].campaign==e)return t;return-1},push:function(e,t,i,s){if(e.notes[i])return new g.Promise((n=>{this.add("push",e,t,i,n,s)&&!this.busy?this.next():n()}))},close:function(e,t,i){return new g.Promise((s=>{let n=e&&this.visibles[e.id];if(n){this.add("unshift",n.campaign,"close",n.noteName,s)&&this.next(1,t,i)||s()}else s()}))},now:function(e,t,i,s){if(e.notes[i])return new g.Promise((n=>{this.add("unshift",e,t,i,n,s)&&this.next(1)||n()}))},visible:function(e){return!(!e||!this.visibles[e.id])},simpleVisibles:function(){let e={};for(let t in this.visibles){let i=this.visibles[t];e[t]={campaignId:t,name:i.noteName}}return e},visibleNotes:function(){return Object.keys(this.visibles).map((function(e){var t=this.visibles[e];return t.campaign.notes[t.noteName]}),this)},waitUntilAvailable:function(){return new g.Promise((e=>{let t=()=>{this.busy?f.setTimeout(t,50):e()};t()}))}},new v})),sndefine("note-anchored",["utils","browser","locale","note-base","layout","behaviour","note-utils","core-sleeknote","constants","css","orchestrator"],(function(e,t,i,s,n,o,r,a,c,h,l){var g=this,f=a.CustomInitSettings.noIFrames;let{sides:u,evenValue:d,paddingCSS:m,fixFlexboxWidths:p,PNG2SVG:v,fixVersion2DOM:b,fixDOM:N,createLabels:E}=r;const O=c.CORE.COMMANDS;return class extends s{constructor(e){super(e),this.kind="AnchoredNote",this.config.current||(this.config.current=O.CLOSE),this.config.next=this.config.current,this.config.reveal=O.OPEN}async afterInsert(){if(await super.afterInsert()){if(this.production&&this.config.version<4){let{support:e}=await g.arequire("package-legacy");e.prepare(this)}return this.setDOMNodeStyles({maxHeight:o.DOMNodeScrolling(this.config,this.editor).style.maxHeight}),this.setScrolling(),!0}}get insertionTarget(){}get visible(){return!this.hidden&&this.config.next}get hidden(){return"close"==this.config.next}get sideBox(){return o.isSideBar(this.config)&&"teaser"!=this.config.type}setScrolling(){if(!this.sideBox||this.editor||"teaser"==this.config.type)return;let e=this.config.boxNode.style,t=this.dims.bounds.other,i=this.sideBox?0:parseInt(e.paddingTop,10)||0+parseInt(e.paddingBottom,10)||0+this.dims.move.y||0+t.top+t.bottom,s="100vh";e.maxHeight=s;let n=this.config.formNode,o=i?`calc(100vh - ${i}px)`:s;n.style.maxHeight=o;let r=n.querySelector(":scope > .flex-container-container");r&&(r.style.maxHeight=o,r.style.alignContent="center",r.querySelectorAll(":scope > .flex-container.flexbox").forEach((e=>{e.style.maxHeight=o,e.style.overflowY="auto",e.style.pointerEvents="all",e.style.minHeight=o,e.firstElementChild.style.height="fit-content",e.firstElementChild.style.minHeight=s})))}setDOMNodeStyles(t){if(f&&("width"in t&&!this.config.relativeWidth&&(t.width="auto"),"height"in t&&(t.height=o.isSideBar(this.config)&&this.editor&&"teaser"!=this.config.type?"100%":"auto")),n.css(this.config,"DOMNode",t),!f&&this.config.profile!=c.PROFILE.DESKTOP&&(this.production||"boolean"!=e.typeStr(a.preview))&&"width"in t&&this.config.boxNode){var i=g.getComputedStyle(this.config.DOMNode).width;this.config.boxNode.style.width=this.config.boxNode.ownerDocument.documentElement.style.width=i}}applyConfig(e){super.applyConfig(e),this.reposition(!0),this.config.reveal=O.OPEN}afterAnimation(){super.afterAnimation(),this.hidden&&h.conceal(this.config.DOMNode)}translateRelative(){var e=this.config.relativeWidth||0,i="%";if(this.config.relativeWidth&&this.config.profile===c.PROFILE.MOBILE)this.production&&t.isLandscape()&&"teaser"==this.config.type&&this.config.relativeWidth<100&&(i="vmin");return{width:e,unit:i}}calculateDimensionsNoIframes(){var t={x:0,y:0};a.CustomInitSettings.moveBox&&(t=a.CustomInitSettings.moveBox(this.config,t));var i=o.distanceFromEdges(this,!0);u.forEach((function(s){if(i[s]>0){if(100==this.config.relativeWidth&&this.config.attach!=s)return;t[e.contains(s,"left","right")?"x":"y"]+=d(i[s])}}),this);var s=0,n="auto";if(this.config.relativeWidth){s=(~i.right?i.right:0)+(~i.left?i.left:0);var r=this.translateRelative(this.config);if("teaser"!=this.config.type)s+=o.DOMNodeScrolling(this.config,this.editor).widthAdjustment,n=[r.width+r.unit," + "+s+"px"];else n=[r.width+r.unit," - "+s+"px"]}return this.dims={width:n,height:o.isSideBar(this.config)&&this.editor&&"teaser"!=this.config.type?"100%":"auto",move:t,bounds:this.getBoxBounds()},this.dims}calculateDimensions(){if(f)return this.calculateDimensionsNoIframes();var t=this.getBoxBounds(),i=o.distanceFromEdges(this,!0),s={x:0,y:0};a.CustomInitSettings.moveBox&&(s=a.CustomInitSettings.moveBox(this.config,s));var n={},r=t.shadow,c=t.other;u.forEach((function(t){var o=Math.max(c[t],r[t]);~i[t]&&(i[t]?r[t]>i[t]?o=Math.max(c[t],i[t]):o<i[t]&&(100==this.config.relativeWidth&&this.config.attach!=t||(s[e.contains(t,"left","right")?"x":"y"]+=i[t]-(100==this.config.relativeWidth?0:d(o)))):o=0),n[t]=d(o)}),this),this.editor||!this.isMobileForm||this.isHello||(n.bottom=200),e.contains(this.config.name,"badge","cover")||h.set(this.config.boxNode,m(n));var l=0,g=0;if(this.config.relativeWidth){l=(~i.right?i.right:0)+(~i.left?i.left:0);var p=this.translateRelative(this.config);g=[p.width+p.unit," - "+l+"px"]}else g=d(t.width+(n.left+n.right));this.setDOMNodeStyles({width:g});var v=0,b=(l=this.config.version>1?n.top+n.bottom:0,this.config.formNode.getBoundingClientRect().height);return this.config.relativeWidth&&(t.height=b),v=t.height+l,o.isPopup(this.config)&&(v=d(v)),this.setDOMNodeStyles({height:v}),this.sideBox&&(v=this.editor?"100%":"100vh"),this.dims={padding:n,move:s,width:this.config.width=g,height:this.config.height=v,bounds:t},this.config.boundsHeight=b,this.dims}reposition(e){this.calculateDimensions(),this.setDOMNodeStyles(n.createPositionStyles(o.boxParameters(this,this.config.current),"to"))}applyFixes(){p.call(this,this.doc),v.call(this,this.doc),b.call(this,this.doc),N.call(this,this.doc),E.call(this,this.doc)}async getFromTo(e){var t,i=this.config.current;switch(e){case O.CURRENT:t=this.config.current,i=O.CLOSE;break;case O.OPEN:case O.REVEAL:await this.onBeforeOpen(),t=O.OPEN;break;default:t=O.CLOSE}return t==i?{}:(this.config.next=t,t!==O.CLOSE&&(this.config.reveal=t),{from:i,to:t})}getCloseFunc(){if("form"==this.config.type&&this.config.teaser)return"openTeaser";if(this.customerPreview){if("teaser"==this.config.type)return"hideTeaserAndDontShowAgain"}else{if(this.preview){if("teaser"==this.config.type)return"openSleeknote";if("success"==this.config.type){let e=this.campaign.getType("teaser")[0];return e?(this.config.teaser=e.config.name,"openTeaser"):(this.config.form=this.campaign.getType("form")[0].config.name,"openSleeknote")}return"previewDummy"}if("teaser"==this.config.type)return"hideTeaserAndDontShowAgain"}return"hideBox"}outsideClick(e,t){if(!this.detectMobileButtonClick(e,t)){var i=this.config.formNode.getBoundingClientRect();if(!(e.clientX>=i.left&&e.clientX<=i.right&&e.clientY>=i.top&&e.clientY<=i.bottom)){var s=this.doc.querySelectorAll("[data-sn-type=close], .sleeknoteMobileClose")[0];s&&this.onClick(e,s)}}}openTeaser(e,t){this.campaign.teaserExist?this.event({command:O.OPEN,type:"teaser",name:this.config.teaser,eventTarget:t}):this.hideBox(e,t)}hideBox(e,t){this.event({command:O.CLOSE,eventTarget:t})}hideTeaserAndDontShowAgain(e,t){this.production&&this.event({command:O.CLOSE,eventTarget:t})}}})),sndefine("note-bar",["utils","note-anchored","behaviour","note-utils","core-sleeknote","constants","css"],(function(e,t,i,s,n,o,r){let{qs:a,allowBackgroundClicks:c,adjustTabletSleekbar:h}=s;const l=o.CORE.COMMANDS;return class extends t{constructor(e){super(e),this.kind="BarNote",this.config.current||(this.config.current=l.CLOSE),this.config.next=this.config.current,this.config.reveal=this.config.toggle?l.MINIMIZE:l.OPEN}async afterInsert(){if(await super.afterInsert())return this.editor||(h.call(this,this.doc),c.call(this,this.doc)),!0}get insertionTarget(){}setToggleIf(t){var i=this.toggleDOMNode(this.config.boxNode||t);if(i){var s=e.contains(this.config.position,o.POS.HELLO2)?0:2;r.set(i,"order",s)}}applyConfig(e){super.applyConfig(e),this.setToggleIf(),this.reposition(!0),this.config.reveal=this.config.toggle?l.MINIMIZE:l.OPEN}toggleDOMNode(e){return e||(e=this.doc),this.config.toggle&&a(e,this.config.toggle)}get isHello(){return!0}toggleToggleButton(e){var t,i=a(this.doc,'[data-sn-custom-step="toggleForm"]');i&&(i.classList.remove("toggle-arrow-up"),i.classList.remove("toggle-arrow-down"),t=this.config.position==o.POS.HELLO?"open"==e?"toggle-arrow-up":"toggle-arrow-down":"open"==e?"toggle-arrow-down":"toggle-arrow-up",i.classList.add(t))}async getFromTo(e){var t,s=this.config.current;switch(e){case l.CURRENT:t=this.config.current,s=l.CLOSE;break;case l.MAXIMIZE:t=l.OPEN;break;case l.OPEN:case l.REVEAL:await this.onBeforeOpen(),t=l.REVEAL;break;case l.MINIMIZE:t=l.MINIMIZE;break;default:t=l.CLOSE}return t==l.REVEAL&&(t=this.config.reveal||(i.isSleekBar(this.config)?l.MINIMIZE:l.OPEN)),t==s?{}:(t!=l.MINIMIZE&&s!=l.MINIMIZE||this.toggleDOMNode()||(t==l.MINIMIZE&&(t=l.OPEN),s==l.MINIMIZE&&(s=l.CLOSE)),this.config.next=t,t!==l.CLOSE&&(this.config.reveal=t),this.toggleToggleButton(t),{from:s,to:t})}toggleForm(e,t){this[(this.config.current==l.MINIMIZE?"maximize":"minimize")+"Form"](e,t)}maximizeForm(e,t){this.event({command:l.MAXIMIZE,eventTarget:t})}minimizeForm(e,t){this.event({command:l.MINIMIZE,eventTarget:t})}}})),sndefine("campaign-anchored",["browser","utils","constants","core-sleeknote","campaign-base","orchestrator","note-anchored","note-bar","font-loader","event-emitter","site-data","global"],(function(e,t,i,s,n,o,r,a,c,h,l,g){var f=this,u=this.document;const d=i.CORE.COMMANDS;return class m extends n{constructor({config:e}){super({config:e}),this.kind="AnchoredCampaign"}handleEvent(e){if(super.handleEvent(e),e.data.campaignId!=this.id)return;let{creator:t,command:s,name:n,ffwd:r,trigger:a}=e.data;switch(t==i.CORE.CREATOR.USER&&(this.config.smartIndex=0),s){case d.CLOSE:if("teaser"==e.data.origin.config.type&&this.tameTeaser(),"queue"==a)break;e.data.result=o.waitUntilAvailable().then((()=>o.close(this,r)));break;case d.QUEUE:if(t==i.CORE.CREATOR.API){if(this.config.campaignId in o.visibles&&"timer"!=e.data.trigger)break}e.data.result=o.push(this,d.OPEN,n);break;case d.OPEN:case d.REVEAL:case d.MAXIMIZE:case d.MINIMIZE:if("queue"==a)break;this.tameTriggers(),e.data.result=o.waitUntilAvailable().then((()=>o.now(this,s,n)))}}static async create(e){let t=new m(e);if(await t.load()||s.editor){t.getType("teaser").length&&!t.config.hidden&&(t.teaserExist=!0);var i=t.notes.teaser&&t.notes.teaser.config.teaserDelay;return i&&i>0&&!s.editor&&await new g.Promise((e=>{f.setTimeout(e,1e3*i)})),t}console.log(`Sleeknote campaign ${t.id} failed to preload`)}async destroy(e,i,s){!o.visible(this)||i?(o.close(this,!0,s),super.destroy(e)):(await o.close(this,!1,s),super.destroy(e)),this.onClickListener&&t.listener(u,"remove",this.onClickListener)("click")}get busy(){return o.busy}async load(){let{template:e,fontsToLoad:s}=await this.html();if(e){for(let[n,o]of t.entries(this.config.steps)){let h={config:{...o,guid:this.guid},campaign:this,html:"content"in e?t.qs(o.id,e.content):e[n],name:n,profileStr:this.profileStr,isTouch:this.isTouch},l=new(t.contains(this.config.position,i.POS.HELLO,i.POS.HELLO2)?a:r)(h);if(!await l.insert(h))return!1;await c(s,l.doc,this.detectFontsRealUsage(s,l.config.boxNode)),this.notes[n]=l}return!0}}aftersubmit(e,t){return super.aftersubmit(e,t),this.API({command:e,noteName:t})}get isHello(){var e=this.getType("form")[0];return e&&e.isHello}ifTrigger(t){switch(t){case"scroll":if(this.config.scroll&&e.scroll.pct()>=this.config.scroll)return this.tameTriggers(t);break;case"exit":if(this.config.exit)return this.tameTriggers(t);break;case"timer":if(this.config.wait)return this.tameTriggers(t)}}launchTriggers(e){0!=this.config.wait&&(this.timer=f.setTimeout(function(){this.ifTrigger("timer")&&e("timer",this)}.bind(this),Math.max(this.config.wait+1e3,0))),this.config.onClick&&!this.onClickListener&&(this.onClickListener=function(e){this.config.onClick&&t.querySelectorClosest(e.target,this.config.onClick.selector)&&f.SleekNote.triggerOnClick(this.config.campaignId,this.config.onClick.triggerOnce)}.bind(this),t.listener(u,"add",this.onClickListener)("click")),this.triggerOnSiteDataIf(),(t.contains(this.getType("form")[0].config.position,i.POS.HELLO,i.POS.HELLO2)||s.preview&&!this.config.wait)&&e("notification",this)}async triggerOnSiteDataIf(){if(this.config.siteData){let e=await f.arequire("float-match");for(let t of this.config.siteData.values())e(l.getSession()[t.property],t.type,t.value)&&f.SleekNote.triggerOnClick(this.config.campaignId,!1)}}tameTeaser(){this.teaserExist=!1,this.tameTriggers()}tameTriggers(e){return this.timer&&f.clearTimeout(this.timer),this.config.hidden=!0,this.config.wait=0,this.config.exit=!1,this.config.scroll=0,!0}API({command:e,noteName:s,keep:n,ffwd:r}){let a=super.API.apply(this,arguments);if(a.handled)return a;const c=i.CORE.API;function l(e=!0){return{result:e,handled:!0}}switch(e){case c.STATUS:let n={};for(let[e,i]of t.entries(o.visibles))n[e]={campaignId:e,name:i.noteName};return l(n);case c.CLOSE:let a,f=o.visibles[this.config.campaignId];return a=f?h(e,{name:f.noteName,creator:i.CORE.CREATOR.API,campaignId:this.config.campaignId,origin:this.notes[f.noteName],trigger:"api",ffwd:r}):g.Promise.resolve(),l(a);case c.QUEUE:case c.OPEN:case c.MAXIMIZE:case c.MINIMIZE:if(t.contains(e,c.MAXIMIZE,c.MINIMIZE)&&!s){let e=o.visibles[this.config.campaignId];e&&(s=e.noteName)}if(s)return l(h(e,{name:s,creator:i.CORE.CREATOR.API,campaignId:this.config.campaignId,origin:this.notes[s],trigger:"api"}));break;case c.VISIBLE:let u,d=o.visible(this),m=this.getType("form")[0].config.position;return d&&(u=o.visibles[this.id].noteName),l({note:u,show:d,position:m})}return{handled:!1}}}})),sndefine("package-anchored",["campaign-anchored","orchestrator","layout"],(function(e,t,i){return{AnchoredCampaign:e,orchestrator:t,layout:i}}));