(function(){let e=this,t=e.document,r=Object.create(null),n=Object.create(null),o=t.currentScript.src.substr(0,t.currentScript.src.lastIndexOf("/")+1);t.body.insertAdjacentHTML("beforeend",'<iframe id=sleeknote-frame style="display:none!important" aria-hidden="true"></iframe>');let a=t.body.lastElementChild.contentWindow;function i(e){let i=a.Promise.resolve();return r[e]||(i=new a.Promise((r,a)=>{if(n[e])n[e].resolve.push(r),n[e].reject.push(a);else{n[e]={resolve:[r],reject:[a]};let i=o,l=t.createElement("script");l.src=i+(~e.indexOf(".js")?e:e+".js"),l.name=e,l.async=!0,t.head.appendChild(l),l.onload=function(){n[e].resolve.forEach(e=>{e()})},l.onerror=function(t){throw n[e].reject.forEach(e=>{e()}),new Error("Error loading: "+t.currentTarget.src)}}})),i.then(()=>r[e])}let l=new a.URL(e.location),c=new a.URLSearchParams(l.search);if(c.has("snlocal")){c.delete("snlocal"),e.history.replaceState(null,null,t.location.origin+t.location.pathname+"?"+c.toString());let r=t.createElement("script");return r.src="https://local.sleeknote.com/frontend2/core.js",void t.head.appendChild(r)}if(!o.includes("local.sleeknote.com")){let e=t.currentScript.src.split("/").pop().split(".")[0];o+=(e.split("-")[1]||"production")+"/"}function s(e){return new a.Promise(t=>{!function(e,t){a.Promise.all(e.map(i)).then(e=>{t&&t.apply(this,e)})}([e],(function(e){return t(e)}))})}e.arequire=s,e.sndefine=function(...n){var o="string"==typeof n[0]?n.shift():t.currentScript.name,l=Array.isArray(n[0])?n.shift():[],c=n[0];r[o]||(r[o]=a.Promise.resolve().then(()=>a.Promise.all(l.map(i)).then(t=>c.apply(e,t))))},this.SleekNote||(this.SleekNote={}),this.SleekNote.root=o,s("package-core-boot").then((async function({launcher:e,SleekNote:t,emit:r,API:n,CONST:o,storage:a}){let i=this;await a.postCreate(),(t.local||t.reset)&&"n"!=t.reset&&await a.forceResetSession(t.reset),t.preview&&await i.arequire("preview-toolbar");let l=await e.add(t.SleekNotes);i.SleekNote.triggerOnclick=i.SleekNote.triggerOnClick=async function(t,r,o){let a=await e.loadForLaunch(t,r);if(a)return o||(o=a.first("form")),a.notes[o]?n("open",t,o):void console.warn("noteName ",o," does not exist in ",a)},i.SleekNote.API=n,l.length?r(o.CORE.EVENTS.LOAD,(function(e){try{return n.apply(null,arguments)}catch(e){console.warn("Error calling Sleeknote API",e)}})):s("package-tracker"),function(){try{return i.location!==i.parent.location}catch(e){}}()&&i.parent.postMessage(i.JSON.stringify({fingerprint:"SleekNote",command:"core-loaded"}),"*")}))}).call(this);