!function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="https://widget.dixa.io/assets/scripts/javascript/",Object.defineProperty(i,"p",{get:function(){try{if("string"!=typeof dixaPublicPath)throw new Error("WebpackRequireFrom: 'dixaPublicPath' is not a string or not available at runtime. See https://github.com/agoldis/webpack-require-from#troubleshooting");return dixaPublicPath}catch(t){return"https://widget.dixa.io/assets/scripts/javascript/"}}}),i(i.s=1)}([function(t){t.exports=JSON.parse('{"medium":{"minimized_view":{"bottom_left":"z-index: 18654331;position: fixed;bottom: 0;left: 0px;border: 0;margin: 0;border-radius: 10px 10px 0 0;width:0;height:0;pointer-events: auto;","bottom_right":"z-index: 18654331;position: fixed;bottom: 0;right: 0px;border: 0;margin: 0;border-radius: 10px 10px 0 0;width:0;height:0;pointer-events: auto;","left":"z-index: 18654331;position: fixed;top: 25%;left:0;border: 0;transform-origin: left bottom 0;transform: rotate(90deg);margin: 0;border-radius: 10px 10px 0 0;width:0;height:0;pointer-events: auto;","right":"z-index: 18654331;position: fixed;top: 25%;right:0;border: 0;transform-origin: right bottom 0;transform: rotate(-90deg);margin: 0;border-radius: 10px 10px 0 0;width:0;height:0;pointer-events: auto;"},"chatbox_view":{"left":"z-index: 18654331;position: fixed;bottom: 0;left: 0px;border: 0;margin: 0;border-radius: 5px 5px 0 0;min-width: 220px;max-width: 400px;height: 75vh;max-height: 600px;pointer-events: auto;","bottom_left":"z-index: 18654331;position: fixed;bottom: 0;left: 0px;border: 0;margin: 0;border-radius: 5px 5px 0 0;min-width: 220px;max-width: 400px;height: 75vh;max-height: 600px;pointer-events: auto;","bottom_right":"z-index: 18654331;position: fixed;bottom: 0;right: 0px;border: 0;margin: 0;border-radius: 5px 5px 0 0;min-width: 220px;max-width: 400px;height: 75vh;max-height: 600px;pointer-events: auto;","right":"z-index: 18654331;position: fixed;bottom: 0;right: 0px;border: 0;margin: 0;border-radius: 5px 5px 0 0;min-width: 220px;max-width: 400px;height: 75vh;max-height: 600px;pointer-events: auto;"}},"small":{"minimized_view":{"left":"position: fixed;border: none;bottom: 0;left:0;width:128px;z-index:18654331;transform-origin: left bottom;width:0;height:0;pointer-events: auto;","bottom_left":"position: fixed;border: none;bottom: 0;left:0;width:128px;z-index:18654331;transform-origin: left bottom;width:0;height:0;pointer-events: auto;","bottom_right":"position: fixed;border: none;bottom: 0;right:0;width:128px;z-index:18654331;transform-origin: right bottom;width:0;height:0;pointer-events: auto;","right":"position: fixed;border: none;bottom: 0;right:0;width:128px;z-index:18654331;transform-origin: right bottom;width:0;height:0;pointer-events: auto;"},"chatbox_view":{"left":"position: fixed;height: 100%;width:100%;opacity: 1;border: none;bottom: 0;left:0;z-index:18654331;transform-origin: left top;width:0;height:0;pointer-events: auto;","bottom_left":"position: fixed;height: 100%;width:100%;opacity: 1;border: none;bottom: 0;left:0;z-index:18654331;transform-origin: left top;width:0;height:0;pointer-events: auto;","bottom_right":"position: fixed;height: 100%;width:100%;opacity: 1;border: none;bottom: 0;left:0;z-index:18654331;transform-origin: right top;width:0;height:0;pointer-events: auto;","right":"position: fixed;height: 100%;width:100%;opacity: 1;border: none;bottom: 0;left:0;z-index:18654331;transform-origin: right top;width:0;height:0;pointer-events: auto;"}}}')},function(t,e,i){t.exports=i(2)},function(t,e,i){"use strict";i.r(e);var n={remove:function(t){return""!==t.trim()&&localStorage.removeItem(t)},set:function(t,e,i){return null!=(!0===i?JSON.stringify(e):e)&&""!==t.trim()&&localStorage.setItem(t,e)},get:function(t,e){if(""!==t.trim()){var i=localStorage.getItem(t);return null!=i&&(!0===e?JSON.parse(i):i)}return!1}},r="wss://sockets.".concat("dixa.io","/v1/enduser/"),o="https://api.".concat("dixa.io","/"),a="https://files.".concat("dixa.io"),s="widget.".concat("dixa.io"),d={WEB_SOCKET_URL:n.get("_dixa-websocket-url")||r,REST_API_URL:n.get("_dixa-rest-api-url")||o,FILES_API_URL:n.get("_dixa-files-api-url")||a,SETTINGS:n.get("_dixa-settings",!0)||null,WIDGET_STATE:n.get("dixa-widget",!0)||null,WIDGET_API_DOMAIN:s},l=i(0);var c={"en-US":{aliases:["en-US"],name:"English"},no:{aliases:["no","nb","nn","nb-NO","nb-NN"],name:"Norsk"},da:{aliases:["da-DK","da"],name:"Dansk"},"pl-PL":{aliases:["pl","pl-PL"],name:"Polski"},"fr-FR":{aliases:["fr-FR","fr","fr-be","fr-ca","fr-lu","fr-mc","fr-ch","fr-FR"],name:"Français"},sv:{aliases:["sv-SE","sv-SV","sv"],name:"Svenska"},"es-ES":{aliases:["es","es-VE","es-PE","es-PR","es-MX","es-CO","es-AR","es-XL","es-ES"],name:"Español"},fi:{aliases:["fi-FI","fi"],name:"Suomi"},"pt-PT":{aliases:["pt-BR","pt","pt-PT"],name:"Português"},"de-DE":{aliases:["de","de-CH","de-LU","de-LI","de-AT","de-DE"],name:"Deutsch"},"it-IT":{aliases:["it","it-CH","it-IT"],name:"Italiano"},nl:{aliases:["nl","nl-BE","nl-NL"],name:"Nederlands"},"lt-LT":{aliases:["lt","lt-LT"],name:"Lietuviškai"},"lv-LV":{aliases:["lv","lv-LV"],name:"Latviešu"},"ru-RU":{aliases:["ru-MO","ru","ru-RU"],name:"Pусский"},"ro-RO":{aliases:["ro","ro-MD","ro-RO"],name:"Română"},"id-ID":{aliases:["id","id-ID"],name:"bahasa Indonesia"},"ms-MY":{aliases:["ms","ms-MY"],name:"Malay"},"ja-JP":{aliases:["ja","ja-JP"],name:"日本語"},"zh-CN":{aliases:["zh-TW","zh-HK","zh-MO","zh-SG","zh-CN"],name:"中文"},"el-GR":{aliases:["el-GR"],name:"Ελληνικά"},"tr-TR":{aliases:["tr-TR"],name:"Türk"},"hi-IN":{aliases:["hi-IN"],name:"हिंदी"},"cs-CZ":{aliases:["cs-CZ"],name:"Čeština"},"ko-KR":{aliases:["ko-KR"],name:"한국어"},"vi-VN":{aliases:["vi-VN"],name:"Tiếng Việt"},"th-TH":{aliases:["th-TH"],name:"ไทย"},"hu-HU":{aliases:["hu-HU"],name:"Magyar"},"hr-HR":{aliases:["hr-HR"],name:"Hırvat"},"et-EE":{aliases:["et","et-EE"],name:"Eesti keel"},is:{aliases:["is"],name:"Íslensku"},ar:{aliases:["ar","ar-AE","ar-BH","ar-DZ","ar-EG","ar-IQ","ar-JO","ar-KW","ar-LB","ar-LY","ar-MA","ar-OM","ar-QA","ar-SA","ar-SY","ar-TN","ar-YE"],name:"العربية"}},u=Object.keys(c);function h(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function p(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function m(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return e.filter((function(t){return!!t})).reduce((function(t,e){return Object.keys(e).forEach((function(i){t[i]=e[i]})),t}),{})}Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null==this)throw TypeError('"this" is null or not defined');var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw TypeError("predicate must be a function");for(var n=arguments[1],r=0;r<i;){var o=e[r];if(t.call(n,o,r,e))return o;r++}},configurable:!0,writable:!0}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var i=Object(this),n=i.length>>>0;if(0===n)return!1;for(var r,o,a=0|e,s=Math.max(a>=0?a:n-Math.abs(a),0);s<n;){if((r=i[s])===(o=t)||"number"==typeof r&&"number"==typeof o&&isNaN(r)&&isNaN(o))return!0;s++}return!1}}),new(function(){function t(){var e=this;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),p(this,"hasAnActiveConversation",(function(t){return t&&t.conversation&&t.conversation.csid?(localStorage.removeItem("dixa-widget"),!1):!!(t&&t.conversation&&t.conversation.token)})),p(this,"getLocalStorageData",(function(){var t=JSON.parse(localStorage.getItem("dixa-widget"));if(t&&t.user&&t.user.bannedAt){var i=t.settings.settings.org_id,n=t.user.currentUser.id,r=new XMLHttpRequest;r.open("GET","".concat(d.REST_API_URL,"v1/users/").concat(n,"/is_banned?organization_id=").concat(i,"&channel=widgetchat")),r.send(),r.onload=function(i){var n=i.target.response;if(!0===JSON.parse(n).data.result);else{var r=m({},t);r.user.bannedAt=null,localStorage.setItem("dixa-widget",JSON.stringify(r)),e.getSettings(r)}},r.onerror=function(t){}}else e.getSettings(t)})),p(this,"getSettings",(function(t){var i=d.WIDGET_STATE&&d.WIDGET_STATE.settings&&d.WIDGET_STATE.settings.transactionId?d.WIDGET_STATE.settings.transactionId:null,n="".concat(location.protocol,"//").concat(location.host).concat(location.pathname),r=t&&t.settings&&t.settings.settings&&t.settings.settings.menu_history?t.settings.settings.menu_history:null,o=t&&t.view&&t.view.currentView?t.view.currentView:null,a=new XMLHttpRequest;window._dixa.initialState={activeConversation:e.hasAnActiveConversation(t),currentView:o},a.open("PUT","".concat(d.REST_API_URL,"v1/widgets/").concat(window._dixa.wid,"/settings")),a.addEventListener("load",(function(t){var i=t.target.response,n=JSON.parse(i);if(n.errors&&0!==n.errors.length)throw n.errors.forEach((function(t){})),localStorage.removeItem("dixa-widget"),new Error("widget cannot be loaded.");var r=d.SETTINGS,o=window._dixa.settings||{},a=null!=r?r:{},s=m(n.data,a,o);e.init(s)})),a.addEventListener("error",console.error),a.setRequestHeader("Content-Type","application/json;charset=UTF-8");var s={url:n};i&&(s.transaction_id=i),r&&(s.menu_history=r),a.send(JSON.stringify(s))})),p(this,"init",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null!==t){var i=window._dixa.initialState.activeConversation,n=3e4;if(i||!1!==t.show_widget)return e.settings=t,e.settings.locale=e.getBrowserLang(),e.settings.wid=window._dixa.wid,null!=document.body?e.iframeConstructor():e.docReady(document,e.iframeConstructor());setTimeout((function(){e.getLocalStorageData()}),n)}})),p(this,"docReady",(function(t,e){return t.addEventListener?t.addEventListener("DOMContentLoaded",(function(){return t.removeEventListener("DOMContentLoaded",arguments.callee,!1),e()}),!1):t.attachEvent?t.attachEvent("onreadystatechange",(function(){if("complete"===t.readyState)return t.detachEvent("onreadystatechange",arguments.callee),e()})):void 0})),p(this,"iframeConstructor",(function(){var t=(document&&document.body&&document.body.clientWidth?document.body.clientWidth:0)>992?"medium":"small",i=[],n=l.small.minimized_view[e.settings.small.minimized_view.position];for(var r in e.settings.device=t,"medium"===t&&(n=l.medium.minimized_view[e.settings.medium.minimized_view.position]),e.settings.supported_languages){var o=e.settings.supported_languages[r];i.push("Intl.~locale.".concat(o))}var a='\n      <!DOCTYPE html>\n      <html class="'.concat(t,'" >\n        <head>\n          <meta charset="utf-8">\n          <base target="_parent" >\n          <title>Dixa widget</title>\n          <meta http-equiv="x-ua-compatible" content="ie=edge">\n          <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />\n          <meta name="robots" content="noindex, nofollow">\n          ').concat("","\n          ").concat("",'\n          <script type="text/javascript" charset="utf-8" src="https://cdn.polyfill.io/v2/polyfill.min.js?features=').concat(i.join(),'" ><\/script>\n        </head>\n        <body></body>\n      </html>'),s=document.createElement("div"),d=document.createElement("iframe");s.id="dixa-iframe-wrapper",s.setAttribute("style","-webkit-overflow-scrolling: touch;z-index: 18654331;"),d.id="dixa-widget-wrapper",d.setAttribute("style",n),d.setAttribute("scrolling","no"),d.setAttribute("height","0"),d.setAttribute("title","Dixa widget"),s.appendChild(d),document.body?document.body.appendChild(s):document.getElementsByTagName("script")[0].appendChild(s),e.addStyle(),window._dixa.settings=e.settings,d.contentWindow.document.open(),d.contentWindow.document.write(a),d.contentWindow.document.close(),e.tryToLoadBundles()})),p(this,"tryToLoadBundles",(function(){var t=document.getElementById("dixa-widget-wrapper").contentDocument;return"complete"===t.readyState?e.buildBundles():e.loadCheck=setInterval((function(){return null!==t.getElementById("dixa-bundle")?e.clearLoadCheck():e.tryToLoadBundles()}),100)})),p(this,"clearLoadCheck",(function(){return clearInterval(e.loadCheck)})),p(this,"buildBundles",(function(){var t=document.getElementById("dixa-widget-wrapper"),i=t.contentDocument;t.contentWindow.dixaPublicPath=window.dixaPublicPath,t.contentWindow._dixa=window._dixa,window.onmessage=function(t){if(null!==t.data&&"handshake"===t.data)return e.processQueue();if(t.data&&!(t.data.source&&t.data.source.indexOf("devtools")>-1))try{e.handlePostMessage(JSON.parse(t.data))}catch(t){}};var n=i.createElement("script");return n.async=1,n.setAttribute("charset","utf-8"),n.id="dixa-bundle",n.src="".concat(e.base_path,"https://widget.dixa.io/assets/scripts/javascript/main.c47e4836.js"),i.querySelector("head").appendChild(n)})),p(this,"processQueue",(function(){var t=document.getElementById("dixa-widget-wrapper"),e=window._dixa.q;if(e&&t)return e.map((function(t){return window._dixa.handler(t)}))})),p(this,"addStyle",(function(){var t=document.createElement("style");t.type="text/css";var e="body.dixa-widget-small-open {overflow: hidden; position: fixed; overflow-y: hidden; width: 100%;height:100%;}";if(window.attachEvent&&!window.opera)t.styleSheet.cssText=e;else{var i=document.createTextNode(e);t.appendChild(i)}document.getElementsByTagName("head")[0].appendChild(t)})),p(this,"getBrowserLang",(function(){var t=navigator.language||navigator.browserLanguage,e=t.split("-");return function(t){return t&&u.find((function(e){return t===e||c[e].aliases.includes(t)}))||t}(e[1]?"".concat(String(e[0]),"-").concat(String(e[1].toUpperCase())):t)})),p(this,"handlePostMessage",(function(t){t.event&&void 0!==e.subscriptions[t.event]&&e.subscriptions[t.event].forEach((function(e){setTimeout((function(){e(t.payload)}),1e3)}))})),!window._dixa)throw new Error('Dixa Widget: ReferenceError missing "window._dixa" The widget needs to load from the snippet script.');this.base_path=null!=window.dixaPublicPath?window.dixaPublicPath:"",this.getLocalStorageData(),this.subscriptions={},window._dixa.handler=function(t){switch(t[0]){case"api.subscribe":e.subscribe(t[1],t[2]);break;case"api.unsubscribe":e.unsubscribe(t[1],t[2]);break;default:var i=JSON.stringify(t,(function(t,e){return"function"==typeof e?e.toString():e}));null!==document.getElementById("dixa-widget-wrapper")&&document.getElementById("dixa-widget-wrapper").contentWindow.postMessage(i,"*")}}}var e,i,n;return e=t,(i=[{key:"subscribe",value:function(t,e){void 0===this.subscriptions[t]&&(this.subscriptions[t]=[]),this.subscriptions[t].push(e)}},{key:"unsubscribe",value:function(t,e){void 0!==this.subscriptions[t]&&(this.subscriptions[t]=this.subscriptions[t].filter((function(t){return e!==t})))}}])&&h(e.prototype,i),n&&h(e,n),t}())}]);
//# sourceMappingURL=loader.js.map